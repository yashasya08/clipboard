{% extends 'base.html' %}
{% block title %}Fileshare{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-12 col-xl-12">
    <div class="card shadow-lg border-0 mt-4">
      <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
        <span class="fw-bold"><i class="bi bi-folder2-open me-2"></i>Fileshare</span>
      </div>
      <div class="card-body bg-light">
        <form method="POST" enctype="multipart/form-data" class="mb-4">
          {{ form.hidden_tag() }}
          <div class="input-group">
            <input id="file" name="file" class="form-control" type="file" multiple required>
            <button class="btn btn-success" type="submit"><i class="bi bi-upload"></i> Upload</button>
          </div>
        </form>
        <h5 class="mb-3">Your Files (expire after 24h)</h5>
        {% if files %}
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Filename</th>
                <th>Uploaded</th>
                <th>Expires</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for file in files %}
              <tr>
                <td>{{ file.filename }}</td>
                <td>{{ file.upload_time.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ file.expiry_time.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>
                  <a href="{{ url_for('download_file', file_id=file.id) }}" class="btn btn-sm btn-info text-white"><i class="bi bi-download"></i> Download</a>
                  <form method="POST" action="{{ url_for('delete_file', file_id=file.id) }}" style="display:inline;">
                    <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Delete this file?')"><i class="bi bi-trash"></i> Delete</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <div class="alert alert-info">No files uploaded yet.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
